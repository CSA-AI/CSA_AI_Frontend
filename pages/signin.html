<!DOCTYPE html>
<html data-theme="light" lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <link rel="apple-touch-icon" sizes="76x76" href="/assets/img/apple-icon.png">
    <link rel="icon" type="image/png" href="/assets/img/favicon.ico">
    <title></title>
    <!-- CSS Files -->
    <link href="/assets/css/main.css" rel="stylesheet" />
    <link href="https://cdn.jsdelivr.net/npm/daisyui@4.10.2/dist/full.css" rel="stylesheet" type="text/css" />
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://kit.fontawesome.com/7095decebb.js" crossorigin="anonymous"></script>
  </head>
  <body>
    <!-- Navbar -->
<nav class="navbar sticky top-0 bg-base-200">
    <!-- Menu for desktop -->
    <div class="w-full hidden md:grid grid-cols-5 gap-2">
        <!-- Left menu -->
        <ul class="col-span-2 menu menu-horizontal justify-end text-xl">
            <li><a href="/blogs">Blogs</a></li>
        </ul>

        <!-- Centered logo -->
        <div class="flex justify-center">
            <a href="/" class="btn btn-ghost text-2xl">
                <img alt="Logo" src="/assets/images/logo.svg" class="w-8" />
                Stock AI
            </a>
        </div>
        <!-- Logo -->


        <!-- Right menu -->
        <ul class="col-span-2 menu menu-horizontal justify-start gap-4 text-xl">
            <li><a href="/pages/signin.html"><i class="fa-solid fa-right-to-bracket"></i>Login</a></li>
        </ul>
    </div>
</nav>

<!-- <div class="navbar bg-base-100 sticky top-0">
    <a href="/" class="flex items-center ml-5">
      <img src="/assets/images/image2.jpg" class="h-16" alt="Flowbite Logo" />
    </a>
  
    <div class="md:flex space-x-10 mr-20">
      <a href="/blogs" class="btn btn-ghost ml-16">BLOGS</a>
    </div>
    
    <div class="navbar-end md:ml-auto md:mr-10">
      <a href="/pages/statslive.html" class="btn btn-ghost mr-10">LIVE STATS</a>
      <a href="/pages/graph_prediction.html" class="btn btn-ghost mr-10">STATS PREDICTIONS</a>
      <a href="/pages/dash.html" class="btn btn-ghost mr-10">DASHBOARD</a>
      <a href="/pages/profile.html" id="profileBtn" class="btn btn-ghost">PROFILE</a>
      <a href="/pages/stockkeys.html" id="profileBtn" class="btn btn-ghost">Stock Dashboard</a>
      <a class="btn btn-ghost" id="signoutBtn" onclick="signout()">SIGNOUT</a>
      <a href="/pages/signin.html" id="signinBtn" class="btn btn-ghost">SIGN IN</a>
    </div>
</div> -->
<script>
    function signout() {
        document.cookie = "token=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;";
        window.location.replace("/index.html");
    }

    function getCookie(name) {
        const value = `; ${document.cookie}`;
        console.log(value)
        const parts = value.split(`; ${name}=`);
        if (parts.length === 2) return parts.pop().split(';').shift();
    }

    getCookie("token");

    document.addEventListener("DOMContentLoaded", function () {
        const token = getCookie("token");
        if (token) {
            document.getElementById('profileBtn').classList.remove('hidden');
            document.getElementById('signoutBtn').classList.remove('hidden');
            document.getElementById('signinBtn').classList.add('hidden');
        } else {
            document.getElementById('profileBtn').classList.add('hidden');
            document.getElementById('signoutBtn').classList.add('hidden');
            document.getElementById('signinBtn').classList.remove('hidden');
        }
    });
</script>
    
    <main>

      <div>
<style>
  .alert {
      position: absolute;
      top: 0;
      left: 50%;
      transform: translateX(-50%);
      opacity: 0;
      transition: opacity 0.5s ease-in-out;
      z-index: 999;
  }

  .alert.show {
      opacity: 1;
  }

  .form {
      display: none;
  }

  .form.active {
      display: block;
  }
  .alert-success {
      position: absolute;
      top: 0;
      left: 50%;
      transform: translateX(-50%);
      opacity: 0;
      transition: opacity 0.5s ease-in-out;
      z-index: 999;
      background-color: #4CAF50;
      color: white;
  }

  .alert-success.show {
      opacity: 1;
  }
</style>

<div role="alert" id="errorAlert" class="alert alert-warning hidden">
  <svg xmlns="http://www.w3.org/2000/svg" class="stroke-current shrink-0 h-6 w-6" fill="none" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z" /></svg>
  <span id="errorMessage">Error Message Here</span>
</div>

<div role="alert" id="successAlert" class="alert alert-success hidden">
  <svg xmlns="http://www.w3.org/2000/svg" class="stroke-current shrink-0 h-6 w-6" fill="none" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" /></svg>
  <span id="successMessage">Success Message Here</span>
</div>


<div style="margin-top: 125px;" class="hero">
  <div class="hero-content flex-col lg:flex-row-reverse">
      <div class="hero-form form card shrink-0 w-full max-w-sm shadow-2xl bg-base-100 active" id="signinForm">
          <form class="card-body">
            <label>
              <span class="text-3xl justify-center"><b>Login</b></span>
            </label>
              <div class="form-control">
                  <label class="label">
                      <span class="label-text">Email</span>
                  </label>
                  <input id="signinEmail" type="email" placeholder="john@example.com" class="input input-bordered" required />
              </div>
              <div class="form-control">
                  <label class="label">
                      <span class="label-text">Password</span>
                  </label>
                  <input id="signinPassword" type="password" placeholder="*********" class="input input-bordered" required />
              </div>
              <div class="form-control">
                  <a href="#" onclick="toggleForm('signup')">Don't have an account?</a>
              </div>
          </form>
          <div class="form-control">
              <button class="btn btn-primary ml-10 mr-10 mb-10" onclick="login()">Sign In</button>
          </div>
      </div>

      <div class="hero-form form card shrink-0 w-full max-w-sm shadow-2xl bg-base-100" id="signupForm">
          <form class="card-body">
            <label>
              <span class="text-3xl justify-center"><b>Register</b></span>
            </label>
              <div class="form-control">
                  <label class="label">
                      <span class="label-text">Email</span>
                  </label>
                  <input id="signupEmail" type="email" placeholder="james@example.com" class="input input-bordered" required />
              </div>
              <div class="form-control">
                  <label class="label">
                      <span class="label-text">Password</span>
                  </label>
                  <input id="signupPassword" type="password" placeholder="*********" class="input input-bordered" required />
              </div>
              <div class="form-control">
                  <label class="label">
                      <span class="label-text">Username</span>
                  </label>
                  <input id="signupName" type="text" placeholder="James" class="input input-bordered" required />
              </div>
              <div class="form-control">
                  <label class="label">
                      <span class="label-text">Date of Birth</span>
                  </label>
                  <input id="signupDob" type="text" placeholder="01/01/2024" class="input input-bordered" required />
              </div>
              <div class="form-control">
                  <a href="#" onclick="toggleForm('signin')">I already have an account</a>
              </div>
          </form>
          <div class="form-control">
              <button class="btn btn-primary ml-10 mr-10 mb-10" onclick="signup()">Next</button>
          </div>
      </div>
  </div>
</div>

<script>
  function toggleForm(formType) {
      const signinForm = document.getElementById("signinForm");
      const signupForm = document.getElementById("signupForm");

      if (formType === 'signin') {
          signinForm.classList.add('active');
          signupForm.classList.remove('active');
      } else if (formType === 'signup') {
          signinForm.classList.remove('active');
          signupForm.classList.add('active');
      }
  }

  const signup_url = 'https://csa-ai.stu.nighthawkcodingsociety.com/api/person/createPerson';
  const login_url = 'https://csa-ai.stu.nighthawkcodingsociety.com/api/person/authenticate';

  function showErrorMessage(message) {
      const errorAlert = document.getElementById("errorAlert");
      const errorMessage = document.getElementById("errorMessage");

      errorMessage.innerText = message;
      errorAlert.classList.remove("hidden");
      errorAlert.classList.add("show");

      setTimeout(() => {
          hideErrorMessage();
      }, 5000);
  }

  function hideErrorMessage() {
      const errorAlert = document.getElementById("errorAlert");
      errorAlert.classList.remove("show");
      errorAlert.classList.add("hidden");
  }

  function showSuccessMessage(message) {
      const successAlert = document.getElementById("successAlert");
      const successMessage = document.getElementById("successMessage");

      successMessage.innerText = message;
      successAlert.classList.remove("hidden");
      successAlert.classList.add("show");

      setTimeout(() => {
          hideSuccessMessage();
      }, 5000);
  }

  function hideSuccessMessage() {
      const successAlert = document.getElementById("successAlert");
      successAlert.classList.remove("show");
      successAlert.classList.add("hidden");
  }

  function login() {
      hideErrorMessage();

      var email = document.getElementById("signinEmail").value;
      var password = document.getElementById("signinPassword").value;

      const params = {
          email: email,
          password: password
      };
      var formattedEmail = email.replace(/\s+/g, '');
      localStorage.setItem('email', formattedEmail);

      fetch(login_url, {
          method: 'POST',
          headers: {
              'Content-Type': 'application/json',
          },
          body: JSON.stringify(params),
      })
          .then(response => response.json())
          .then(data => {
              document.cookie = "token=" + data.token + "; path=/";
              console.log(data)
              if (data.status !== 401) {
                  window.location.replace("{{ site.baseurl }}/aslsignin.html");
              } else {
                  console.log("bad email and password");
                  showErrorMessage("Invalid email or password");
              }
          })
          .catch(error => {
              console.error('Error:', error);
              showErrorMessage("An error occurred. Please try again later.");
          });
  }

  function signup() {
      hideErrorMessage();

      var email = document.getElementById("signupEmail").value;
      var password = document.getElementById("signupPassword").value;
      var name = document.getElementById("signupName").value;
      var dob = document.getElementById("signupDob").value;
      var emailInput = document.getElementById("signupEmail");
      var passwordInput = document.getElementById("signupPassword");
      var nameInput = document.getElementById("signupName");
      var dobInput = document.getElementById("signupDob");

      const params2 = {
          name: name,
          email: email,
          password: password,
          dob: dob
      };
      var formattedName = name.replace(/\s+/g, '');
      localStorage.setItem('signupName', formattedName);

      fetch(signup_url, {
          method: 'POST',
          headers: {
              'Content-Type': 'application/json',
          },
          body: JSON.stringify(params2),
      })
          .then(response => response.json())
          .then(data => {
              console.log(data);
              if (data.status !== 401) {
                  window.location.replace("{{ site.baseurl }}/pages/aslsignup.html");


                  emailInput.value = "";
                  nameInput.value = "";
                  passwordInput.value = "";
                  dobInput.value = "";
              } else {
                  console.log("Signup failed");
                  showErrorMessage("Signup failed. Please check your information and try again.");
              }
          })
          .catch(error => {
              console.error('error:', error);
              showErrorMessage("An error occurred. Please try again later.");
          });
  }
</script>
